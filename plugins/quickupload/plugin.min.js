tinymce.PluginManager.add("quickupload",function(a){var b=a.settings.plupload_basepath,c=a.settings.upload_url,d=a.settings.upload_callback,e=a.settings.upload_error,f=a.settings.upload_post_params,g=a.settings.upload_file_size;a.addButton("quickupload",{icon:"image",id:a.id+"_quickupload",tooltip:"Insert/edit image",stateSelector:"img:not([data-mce-object],[data-mce-placeholder])"}),a.on("init",function(){var h=a.id+"_quickupload",i=document.getElementById(h),j=i.childNodes[0].childNodes[0],k=a.theme.panel.controlIdLookup[h],l=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:h,url:c,filters:{max_file_size:g?g:"1mb",mime_types:[{title:"Image files",extensions:"jpg,gif,png"}]},multipart_params:f,multi_selection:!1,flash_swf_url:b+"Moxie.swf",silverlight_xap_url:b+"Moxie.xap",init:{Init:function(){return!0},FilesAdded:function(a){j.className="mce-ico mce-i-restoredraft",k.settings.tooltip="Uploading..",a.start()},UploadProgress:function(a,b){k.settings.tooltip=b.percent+"%"},FileUploaded:function(b,c,e){j.className="mce-ico mce-i-image",k.settings.tooltip="Insert/edit image";var c=d(e,c,b);c&&(a.focus(),a.selection.setContent(a.dom.createHTML("img",{src:c})))},UploadComplete:function(){},Error:function(a,b){e(b,a)}}});l.init()})});