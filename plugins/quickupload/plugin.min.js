tinymce.PluginManager.add("quickupload",function(a){var b=a.settings.plupload_basepath,c=a.settings.upload_url,d=a.settings.upload_callback,e=a.settings.upload_post_params,f=a.settings.upload_file_size;a.addButton("quickupload",{icon:"image",id:a.id+"_quickupload",tooltip:"Insert/edit image",stateSelector:"img:not([data-mce-object],[data-mce-placeholder])"}),a.on("init",function(){var g=a.id+"_quickupload",h=document.getElementById(g),i=h.childNodes[0].childNodes[0],j=a.theme.panel.controlIdLookup[g],k=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:g,url:c,filters:{max_file_size:f?f:"1mb",mime_types:[{title:"Image files",extensions:"jpg,gif,png"}]},multipart_params:e,multi_selection:!1,flash_swf_url:b+"Moxie.swf",silverlight_xap_url:b+"Moxie.xap",init:{Init:function(){return!0},FilesAdded:function(a){i.className="mce-ico mce-i-restoredraft",j.settings.tooltip="Uploading..",a.start()},UploadProgress:function(a,b){j.settings.tooltip=b.percent+"%"},FileUploaded:function(b,c,e){i.className="mce-ico mce-i-image",j.settings.tooltip="Insert/edit image";var c=d(e);c&&(a.focus(),a.selection.setContent(a.dom.createHTML("img",{src:c})))},UploadComplete:function(){},Error:function(){}}});k.init()})});